<!------------------------------------ Desktop Screen ----------------------------------------------------->
<!------------------------------------ Desktop Screen ----------------------------------------------------->
<!------------------------------------ Desktop Screen ----------------------------------------------------->
<div class="main-content home-bg" *ngIf="screenWidth > 430">
  <div class="container-fluid" style="max-width: 2576px">
    <div class="row m-0 w-100 main-wrapper">
      <div
        class="col-3 py-3 tab-1"
        [ngClass]="sidebarChatOpened? 'tab-1-opened' : 'tab-1-closed'"
      >
        <div class="tab-1-sec-1" style="height: 93%">
          <div style="height: 13%">
            <div class="row m-0 justify-content-between align-items-center">
              <p *ngIf="sidebarChatOpened" class="m-0 tab-1-title">Messages</p>
              <img
                *ngIf="isAllClientsLoading == false"
                #newChatMenuTrigger="matMenuTrigger"
                [matMenuTriggerFor]="newChatMenu"
                class="add-new-chat"
                src="assets/img/svg/chat-add.svg"
                alt=""
              />
              <mat-menu #newChatMenu="matMenu">
                <div class="newChat-menu">
                  <div
                    class="row m-0 search-bar-client mt-3 mb-4"
                    (click)="$event.stopPropagation()"
                  >
                    <img
                      class="mr-2"
                      src="assets/img/svg/searchbar/search-normal-1.svg"
                      alt=""
                    />
                    <input type="text" placeholder="Search" />
                  </div>
                  <div
                    class="all-c row m-0"
                    *ngFor="let c of allClients"
                    (click)="newChatOpen(c)"
                  >
                    <div
                      class=""
                      *ngIf="c.profile_photo != ''"
                      style="
                        width: 2.5rem;
                        height: 2.5rem;
                        overflow: hidden;
                        background-image: url('{{ usrImgPath }}{{ c.profile_photo }}');
                        background-size: cover;
                        background-position: center;
                        background-repeat: no-repeat;
                        border-radius: 50%;
                      "
                    ></div>
                    <img
                      class=""
                      *ngIf="c.profile_photo == ''"
                      src="assets/img/faces/avatar.webp"
                      alt=""
                      style="
                        max-width: 2.5rem;
                        min-width: 2.5rem;
                        max-height: 2.5rem;
                        min-height: 2.5rem;
                        border-radius: 50%;
                        user-select: none;
                        pointer-events: none;
                      "
                    />
                    <div class="col">
                      <p class="m-0 name">{{c.firstname | titlecase}}</p>
                      <p class="m-0 auth">{{c.auth_type | titlecase}}</p>
                    </div>
                  </div>
                </div>
              </mat-menu>
            </div>

            <div *ngIf="sidebarChatOpened" class="row m-0 search-bar mt-3 mb-4">
              <img
                class="mr-2"
                src="assets/img/svg/searchbar/search-normal-1.svg"
                alt=""
              />
              <input type="text" placeholder="Search" />
            </div>
          </div>

          <div
            *ngIf="sidebarChatOpened"
            class="mb-3"
            style="overflow: auto; height: 86%"
          >
            <div class="chats-wrapper mt-3 mr-2" *ngFor="let c of chats">
              <div
                class="row m-0 align-items-center"
                *ngIf="chats_loading == true"
              >
                <ngx-skeleton-loader
                  appearance="circle"
                  [theme]="{ width: '3rem', height: '3rem' }"
                >
                </ngx-skeleton-loader>
                <ngx-skeleton-loader
                  class="ml-2"
                  [theme]="{ width: '15rem', height: '50px', 'margin':'0px' }"
                >
                </ngx-skeleton-loader>
              </div>

              <div
                class="row m-0"
                *ngIf="chats_loading == false"
                (click)="newChatOpen(c)"
              >
                <div
                  class=""
                  *ngIf="c.profile_photo != ''"
                  style="
                    width: 2.5rem;
                    height: 2.5rem;
                    overflow: hidden;
                    background-image: url('{{ usrImgPath }}{{ c.profile_photo }}');
                    background-size: cover;
                    background-position: center;
                    background-repeat: no-repeat;
                    border-radius: 50%;
                  "
                ></div>
                <img
                  class=""
                  *ngIf="c.profile_photo == ''"
                  src="assets/img/faces/avatar.webp"
                  alt=""
                  style="
                    max-width: 2.5rem;
                    min-width: 2.5rem;
                    max-height: 2.5rem;
                    min-height: 2.5rem;
                    border-radius: 50%;
                    user-select: none;
                    pointer-events: none;
                  "
                />

                <div class="col my-auto">
                  <p class="m-0 client-name">
                    {{c.firstname | titlecase}} {{c.lastname | titlecase}}
                  </p>
                  <p class="m-0 client-auth">{{c.auth_type | titlecase}}</p>
                </div>
                <div class="col-2 p-0">
                  <p class="messaged-time m-0">2h ago</p>
                  <div
                    *ngIf="c.new_msg != undefined"
                    class="mt-1 new-messages"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          [ngClass]="sidebarChatOpened? '' : 'justify-content-center'"
          class="row m-0 settings"
          style="height: 7%"
        >
          <img
            [ngClass]="sidebarChatOpened? 'mr-2' : 'mr-0'"
            src="assets/img/svg/setting-2.svg"
            alt=""
          />
          <p *ngIf="sidebarChatOpened" class="m-0">Settings</p>
        </div>
      </div>
      <div class="col py-3 tab-2">
        <div
          class="row m-0 top-bar justify-content-between"
          style="height: 7%"
          *ngIf="currentChat_usr == undefined"
        >
          <img
            (click)="sideBarCloseChats()"
            class="mr-4 my-auto sideBar-toggler"
            src="assets/img/svg/sidebar/menu.svg"
            alt=""
          />

          <img
            class="more my-auto mr-2"
            src="assets/img/pngs/option.png"
            alt=""
          />
        </div>
        <div
          class="row m-0 top-bar"
          style="height: 7%"
          *ngIf="currentChat_usr != undefined"
        >
          <img
            (click)="sideBarCloseChats()"
            class="mr-4 my-auto sideBar-toggler"
            src="assets/img/svg/sidebar/menu.svg"
            alt=""
          />

          <div
            class=""
            *ngIf="currentChat_usr.profile_photo != ''"
            style="
              width: 2.5rem;
              height: 2.5rem;
              overflow: hidden;
              background-image: url('{{ usrImgPath }}{{ currentChat_usr.profile_photo }}');
              background-size: cover;
              background-position: center;
              background-repeat: no-repeat;
              border-radius: 50%;
            "
          ></div>
          <img
            class=""
            *ngIf="currentChat_usr.profile_photo == ''"
            src="assets/img/faces/avatar.webp"
            alt=""
            style="
              max-width: 2.5rem;
              min-width: 2.5rem;
              max-height: 2.5rem;
              min-height: 2.5rem;
              border-radius: 50%;
              user-select: none;
              pointer-events: none;
            "
          />

          <div class="col my-auto" *ngIf="currentChat_usr != undefined">
            <p class="m-0 name">{{currentChat_usr.firstname | titlecase}}</p>
            <p class="m-0 status">Active 2 hours ago</p>
          </div>
          <img
            class="more my-auto mr-2"
            src="assets/img/pngs/option.png"
            alt=""
          />
        </div>
        <div
          #msg_bar
          *ngIf="currentChat_usr != undefined"
          class="messages-bar"
          style="
            height: 78%;
            overflow: auto;
            max-height: 37rem;
            padding-right: 10px;
            padding-bottom: 10px;
          "
        >
          <div
            *ngFor="let m of chatroom_msgs"
            [ngClass]="m.recieved == 0 ? 'message-send-wrp' : 'message-coming-wrp'"
          >
            <div
              class="mt-3"
              [ngClass]="m.recieved == 0 ? 'message-send' : 'message-coming'"
            >
              <span class="m-0 msg">{{m.message}}</span> <br />
              <span class="m-0 time">{{m.time | date : 'shortTime'}}</span>
            </div>
          </div>
        </div>
        <div
          class="bottom-bar"
          style="height: 15%"
          *ngIf="currentChat_usr != undefined"
        >
          <textarea
            [(ngModel)]="sending_msg"
            class="mt-2 text-area"
            rows="3"
            placeholder="Message.."
          ></textarea>
          <div class="row m-0 mt-2 justify-content-between">
            <div class="row m-0">
              <img
                matTooltip="Attach File"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
                class="bottom-bar-btns ml-2 mr-4"
                src="assets/img/svg/attachment.svg"
                alt=""
              />
              <img
                matTooltip="Send Media"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
                style="width: 20px"
                class="bottom-bar-btns mr-4"
                src="assets/img/svg/image.svg"
                alt=""
              />
              <img
                matTooltip="Emoji"
                matTooltipClass="tooltip"
                matTooltipPosition="above"
                style="width: 18px"
                class="bottom-bar-btns"
                src="assets/img/svg/smile.svg"
                alt=""
              />
            </div>

            <img
              (click)="sendMsg()"
              matTooltip="Send Message"
              matTooltipClass="tooltip"
              matTooltipPosition="above"
              style="width: 20px"
              class="bottom-bar-btns"
              src="assets/img/svg/send.svg"
              alt=""
            />
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
